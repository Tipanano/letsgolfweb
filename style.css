body {
    font-family: sans-serif;
    line-height: 1.6;
    padding: 20px;
    background-color: #f4f4f4;
    color: #333;
}

h1, h2 {
    color: #005f40; /* Dark green */
}

/* Original styling for blocks - removing game-status and ball-position-control */
#instructions, #timing-info, #shot-result {
    background-color: #fff;
    border: 1px solid #ddd;
    padding: 15px;
    margin-bottom: 15px;
    border-radius: 5px;
}

#status-text, #swing-speed-text, #backswing-duration,
#rotation-start-offset, #arms-start-offset, #wrists-start-offset,
#ball-position-text { /* Added #ball-position-text */
    font-weight: bold;
    color: #007bff; /* Blue */
}

#result-text {
    font-size: 1.1em;
    font-weight: bold;
    color: #28a745; /* Green */
}

#instructions p {
    margin: 5px 0;
}

/* --- Timing Bars --- */
#timing-bars {
    background-color: #fff;
    border: 1px solid #ddd;
    padding: 15px;
    /* margin-bottom: 15px; */ /* Removed default margin */
    border-radius: 5px;
    /* Assuming parent (#game-interface) will constrain width */
    box-sizing: border-box; /* Include padding in width calculation */
    margin-bottom: 10px; /* Add some space below the bars */
}

.timing-bar-container {
    display: flex;
    align-items: center;
    margin-bottom: 8px;
}

.bar-label {
    width: 90px; /* Adjust as needed */
    font-size: 0.9em;
    text-align: right;
    margin-right: 10px;
    color: #555;
}

.timing-bar {
    flex-grow: 1;
    height: 20px;
    background-color: #e9ecef;
    border: 1px solid #ced4da;
    border-radius: 3px;
    position: relative; /* Needed for absolute positioning of children */
    overflow: hidden; /* Hide overflow */
}

.progress {
    height: 100%;
    width: 0%; /* Starts at 0 */
    background-color: #28a745; /* Green progress */
    transition: width 0.05s linear; /* Smooth transition for progress */
    position: absolute;
    left: 0;
    top: 0;
}

.ideal-window {
    position: absolute;
    top: 0;
    height: 100%;
    background-color: rgba(0, 123, 255, 0.3); /* Semi-transparent blue */
    border-left: 1px dashed #007bff;
    border-right: 1px dashed #007bff;
    z-index: 1; /* Above progress */
    /* Left and width will be set by JS */
}

.marker {
    position: absolute;
    top: -2px; /* Slightly above bar */
    bottom: -2px; /* Slightly below bar */
    width: 3px;
    background-color: #dc3545; /* Red marker */
    z-index: 2; /* Above ideal window */
    display: none; /* Hidden initially */
    /* Left will be set by JS */
}

/* Specific style for the ideal backswing marker */
#ideal-backswing-marker {
    background-color: transparent; /* No background fill */
    border-left: 2px solid #ffc107; /* Yellow line for ideal point */
    border-right: none;
    width: 2px; /* Just a line */
    /* Left position will be set by JS */
}

/* --- Main Layout Container --- */
#main-layout {
    display: flex;
    gap: 15px; /* Space between visual area and ball position */
    margin-bottom: 15px; /* Space below the main layout */
}

/* --- Visuals Container --- */
#visuals-container {
    /* margin-top: 20px; */ /* Removed margin, handled by parent */
    flex-grow: 1; /* Allow it to take available horizontal space */
    background-color: #ddd; /* Placeholder background */
    border: 1px solid #bbb;
    border-radius: 5px;
    position: relative; /* Make this the positioning context */
    /* Ensure it contains the canvas height */
    min-height: 400px; /* Match canvas height */
}

#golf-canvas {
    display: block; /* Remove extra space below canvas */
    width: 100%;   /* Make canvas responsive */
    height: 400px; /* Example fixed height */
    background-color: #aaddcc; /* Placeholder canvas background */
    transform: scaleX(-1) !important; /* Explicitly flip horizontally for testing */
}

/* --- Ball Position Control --- */
.stance-visual {
    display: flex;
    flex-direction: column; /* Stack items vertically */
    align-items: center;    /* Center items horizontally */
    justify-content: space-between; /* Push feet to top/bottom */
    background-color: #e9ecef;
    padding: 10px;
    border-radius: 4px;
    margin-top: 10px;
    height: 150px; /* Make it taller */
    position: relative; /* For positioning the ball marker */
    width: 50px;  /* Make it narrower */
    margin-left: auto; /* Center the container */
    margin-right: auto;
}

.foot {
    width: 30px;
    height: 30px;
    background-color: #6c757d; /* Gray */
    border: 1px solid #495057;
    border-radius: 3px;
    /* Removed auto margins */
}

/* #left-foot is now the top foot (front foot) */
/* #right-foot is now the bottom foot (back foot) */

.ball-marker {
    width: 15px;
    height: 15px;
    background-color: #fff; /* White ball */
    border: 1px solid #333;
    border-radius: 50%; /* Make it round */
    position: absolute; /* Position relative to stance-visual */
    left: 50%; /* Center horizontally */
    transform: translateX(-50%); /* Adjust horizontal centering */
    top: 50%; /* Start centered vertically */
    margin-top: -7.5px; /* Adjust vertical centering (half height) */
    transition: top 0.1s ease-in-out; /* Smooth vertical movement */
    z-index: 1;
}

/* --- Game Status (Now below main layout) --- */
#game-status {
    /* position: absolute; */ /* REMOVED */
    background-color: rgba(255, 255, 255, 0.85); /* Semi-transparent white */
    border: 1px solid #ccc; /* Lighter border */
    padding: 10px;
    /* margin-bottom: 0; */ /* REMOVED */
    border-radius: 5px;
    /* z-index: 10; */ /* REMOVED */
    width: 100%; /* Take full width of #game-interface */
    box-sizing: border-box;
    display: flex; /* Arrange items horizontally */
    gap: 20px; /* Space between items */
    align-items: center; /* Vertically align items */
}

/* --- Ball Position Control (Now side panel) --- */
#ball-position-control {
    /* position: absolute; */ /* REMOVED */
    background-color: rgba(255, 255, 255, 0.85); /* Semi-transparent white */
    border: 1px solid #ccc; /* Lighter border */
    padding: 10px;
    /* margin-bottom: 0; */ /* REMOVED */
    border-radius: 5px;
    /* z-index: 10; */ /* REMOVED */
    flex-basis: 200px; /* Set fixed width */
    flex-shrink: 0; /* Prevent shrinking */
    box-sizing: border-box;
    /* top: 10px; */ /* REMOVED */
    /* right: 10px; */ /* REMOVED */
}

/* --- Visual Info Overlay (NEW) --- */
#visual-info-overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none; /* Allow clicks to pass through to canvas */
    z-index: 5; /* Position above canvas */
    padding: 10px;
    box-sizing: border-box;
    color: white; /* Example text color */
    text-shadow: 1px 1px 2px black; /* Default text shadow for overlay */
    display: flex;
    flex-direction: column;
    justify-content: space-between; /* Push elements to top/bottom */
    align-items: stretch; /* Make children stretch full width */
    /* font-size is now part of .overlay-text-item */
}

/* NEW Common class for all overlay text items */
.overlay-text-item {
    font-size: 1.1em;
    font-weight: normal; /* Ensure consistent normal weight */
    color: white; /* Ensure consistent color */
    text-shadow: 1px 1px 2px black; /* Ensure consistent shadow */
    margin-bottom: 2px; /* Consistent spacing */
}

/* Positioning for overlay elements */
.overlay-top, .overlay-bottom {
    display: flex;
    justify-content: space-between; /* Space out main left/right blocks */
    width: 100%;
}

/* Align text within the corner blocks */
.overlay-top-left, .overlay-bottom-left {
    text-align: left;
}

.overlay-top-right {
    text-align: right;
}

/* Remove individual styling if .overlay-text-item is applied directly to child divs */
/* .overlay-top-left div, .overlay-top-right div, .overlay-bottom-left div { */
    /* margin-bottom: 2px; /* Now part of .overlay-text-item */
/* } */

/* --- Overlay Mode Visibility --- */
/* Hide all mode-specific overlay sections by default */
#visual-info-overlay .mode-play-hole,
#visual-info-overlay .mode-closest-to-flag,
#visual-info-overlay .mode-range {
    display: none;
}

/* Show the correct sections based on body class */
body.mode-play-hole #visual-info-overlay .mode-play-hole,
body.mode-closest-to-flag #visual-info-overlay .mode-closest-to-flag,
body.mode-range #visual-info-overlay .mode-range {
    display: block; /* Or flex if they are containers */
}
/* Adjust display for flex containers if needed */
body.mode-play-hole #visual-info-overlay .overlay-top-left.mode-play-hole,
body.mode-closest-to-flag #visual-info-overlay .overlay-top-left.mode-closest-to-flag,
body.mode-range #visual-info-overlay .overlay-top-left.mode-range,
body.mode-play-hole #visual-info-overlay .overlay-bottom-left.mode-play-hole {
     display: block; /* These are divs containing text lines */
}


/* Optional: Add specific alignment if needed */
/* #overlay-hole-info { text-align: left; } */
/* #overlay-distance { text-align: right; } */
/* #overlay-shot-info { text-align: left; } */
/* #overlay-score-info { text-align: right; } */

/* Adjust text color if needed for contrast */
#game-status label, #game-status p,
#ball-position-control h2, #ball-position-control p {
    color: #333; /* Ensure readability */
}

/* Adjust ball position visual if needed */
#ball-position-control .stance-visual {
    /* Maybe reduce height/width if it feels too large as an overlay */
    /* height: 100px; */
    /* width: 40px; */
    background-color: rgba(233, 236, 239, 0.85); /* Semi-transparent */
}

/* --- Game Mode Specific Styles --- */

/* Hide instructions when not in range mode */
body:not(.mode-range) #instructions {
    display: none;
}

/* --- Game Mode Specific Styles --- */

/* Hide instructions when not in range mode */
body:not(.mode-range) #instructions {
    display: none;
}

/* Hide all mode-specific info panels by default */
.mode-info-panel {
    display: none;
    padding: 15px;
    margin-bottom: 15px;
    border-radius: 5px;
}

/* Closest to Flag UI visibility */
#closest-to-flag-info {
    /* display: none; /* Hidden by default via .mode-info-panel */
    background-color: #e8f4f8; /* Light blue background */
    border: 1px solid #b8dce8;
    /* padding: 15px; */ /* Handled by .mode-info-panel */
    /* margin-bottom: 15px; */ /* Handled by .mode-info-panel */
    /* border-radius: 5px; */ /* Handled by .mode-info-panel */
}
body.mode-closest-to-flag #closest-to-flag-info {
    display: block; /* Show only in this mode */
}

/* --- Added for Backswing Bar Markers --- */

/* Generic style for line markers on timing bars */
.timing-marker {
    position: absolute;
    top: -1px; /* Align with top edge or slightly above */
    bottom: -1px; /* Align with bottom edge or slightly below */
    width: 2px; /* Thickness of the marker line */
    background-color: #007bff; /* Blue, distinct from ideal window and progress */
    z-index: 3; /* Ensure it's above progress and ideal windows */
    display: none; /* Hidden by default, JS will show it */
    /* 'left' position will be set by JS */
}

/* Specific styling for the hip initiation marker, if needed, */
/* otherwise it will use .timing-marker styles. */
/* #hip-initiation-marker { */
    /* background-color: #another_color; */ /* Example: Different color if desired */
/* } */

/* Style for the post-shot ideal J press feedback window on the backswing bar */
.ideal-timing-feedback-backswing {
    position: absolute;
    top: 0;
    height: 100%;
    background-color: rgba(70, 130, 180, 0.35); /* Steel Blue, semi-transparent */
    border-left: 1px dashed steelblue;
    border-right: 1px dashed steelblue;
    z-index: 1; /* Below other markers, above progress fill if progress has lower z-index */
    display: none; /* Initially hidden */
    box-sizing: border-box;
    /* 'left' and 'width' will be set by JS */
}

/* --- Main Menu & Game View --- */
#main-menu {
    display: flex; /* Use flexbox for centering */
    flex-direction: column; /* Stack items vertically */
    align-items: center; /* Center items horizontally */
    justify-content: center; /* Center items vertically */
    min-height: 80vh; /* Take up most of the viewport height */
    text-align: center;
    padding: 20px;
}

#main-menu h2 {
    margin-bottom: 30px;
}

#main-menu > div { /* Style for the direct children divs within main-menu */
    margin-bottom: 20px;
    padding: 20px;
    border: 1px solid #ccc;
    border-radius: 8px;
    background-color: #f9f9f9;
    width: 80%;
    max-width: 400px; /* Max width for menu sections */
}

#main-menu button {
    padding: 10px 15px;
    font-size: 1em;
    margin: 5px;
    cursor: pointer;
}

#game-view {
    /* Initially hidden by inline style, but can be controlled here too */
    /* display: none; */
}

/* When game-view is active, make visuals larger */
#game-view #visuals-container {
    min-height: 600px; /* Increased height */
    /* flex-grow: 1; already set, ensure it expands */
}

#game-view #golf-canvas {
    height: 600px; /* Increased height */
    /* width: 100%; already set */
}

/* --- Shot Result Pop-up --- */
#shot-result {
    position: fixed; /* Fixed position to overlay on content */
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%); /* Center the pop-up */
    width: 80%;
    max-width: 450px; /* Max width for the pop-up */
    background-color: #fff;
    border: 2px solid #005f40; /* Dark green border */
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    z-index: 1002; /* Ensure it's above other game elements */
    display: none; /* Hidden by default, shown by JS */
}

#shot-result h2 {
    margin-top: 0;
    text-align: center;
}

#shot-result p {
    margin: 8px 0;
}

#shot-result #next-shot-button {
    display: block; /* Make button take full width */
    width: 50%;
    padding: 10px;
    margin: 20px auto 0; /* Center button */
    background-color: #007bff;
    color: white;
    border: none;
    border-radius: 5px;
    font-size: 1em;
}

/* --- Shot Summary Widget (NEW) --- */
#shot-summary-widget {
    position: absolute;
    bottom: 10px;
    right: 10px;
    /* color, text-shadow, font-size are handled by .overlay-text-item if applied to children */
    text-align: right;
    z-index: 6;
    pointer-events: auto;
    background-color: transparent;
    padding: 0;
    border-radius: 0;
}

/* #shot-summary-widget div will now use .overlay-text-item */
/* #shot-summary-widget div { */
    /* margin-bottom: 2px; */ /* Handled by .overlay-text-item */
    /* font-weight: normal; */ /* Handled by .overlay-text-item */
/* } */

#shot-summary-widget button#show-details-button {
    background-color: transparent;
    color: white;
    text-shadow: 1px 1px 2px black;
    border: none;
    border-radius: 0;
    width: auto;
    height: auto;
    font-size: 1.2em; /* Button can be slightly larger/bolder */
    font-weight: bold;
    line-height: normal;
    text-align: center;
    padding: 0 5px; /* Minimal padding if needed */
    cursor: pointer;
    margin-top: 0px; /* Adjust as needed, or align with flex */
    display: inline; /* Make it flow with text if desired, or keep as block/inline-block */
}

#shot-summary-widget button#show-details-button:hover {
    color: #aaa; /* Simple hover effect, or remove if not desired */
    background-color: transparent;
}
